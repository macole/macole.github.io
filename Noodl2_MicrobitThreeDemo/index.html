<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=auto">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="noodl-app.png">
    <title>Noodl Viewer</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            user-select: none;
            background-color: black;
        }

        img {
            -webkit-user-drag: none;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0,0,0,0);
            cursor: default;
        }

    </style>
</head>
<body>
<noscript>
    You need to enable JavaScript to run this app.
</noscript>

<div id="root" style="display: flex; width:100%; height: 100%; overflow: hidden; position: fixed;"></div>

<script src="react.production.min.js"></script>
<script src="react-dom.production.min.js"></script>



<script type="application/javascript">
    window.__noodl_modules = [];
    window.Noodl = {
        defineModule:function(m) {
            window.__noodl_modules.push(m);
        }
    }
    window.projectData = {"settings":{},"components":[{"name":"/MicrobitControl","nodes":[{"id":"ba2f28d3-9d3a-8dfe-ba80-4f1e5bd5b292","type":"Group","parameters":{"backgroundColor":"#FFFFFF"},"ports":[{"name":"width","type":{"name":"number","units":["%","px","vw"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Width","default":"100","index":2},{"name":"height","type":{"name":"number","units":["%","px","vh"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Height","default":"100","index":3},{"name":"borderWidth","type":{"name":"number","units":["px"],"defaultUnit":"px"},"plug":"input","group":"Style","displayName":"Border Width","default":0,"index":353},{"name":"borderColor","type":"color","plug":"input","group":"Style","displayName":"Border Color","index":354}],"children":[{"id":"3bd767ce-d2aa-6730-64a5-ba3ec4066371","type":"Canvas","parameters":{"sizeMode":"explicit","pointerEventsEnabled":false},"ports":[{"name":"width","type":{"name":"number","units":["%","px","vw"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Width","default":"100","index":2},{"name":"height","type":{"name":"number","units":["%","px","vh"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Height","default":"100","index":3}],"children":[]},{"id":"5d301d92-e5c3-f2e9-6da9-b837271ceb24","type":"Text","parameters":{"fontSize":{"value":30,"unit":"px"},"text":"Noodl Canvas Demo","position":"absolute","alignY":"center","alignX":"center","sizeMode":"contentSize","style":"{\n      filter:\"drop-shadow(0px 5px 10px rgb(0, 0, 0))\"\n}","transformY":{"value":50,"unit":"px"},"fontFamily":"Impact","color":"#FF3700"},"ports":[],"children":[]},{"id":"fdceb457-e76a-935f-7caa-1d9500925bfb","type":"Drag","parameters":{"axis":"both"},"ports":[],"children":[{"id":"78cfc2cd-d239-7058-9cbd-b9b8194f406d","type":"Image","parameters":{"src":"imgs/shimizu.png","sizeMode":"contentWidth","height":{"value":20,"unit":"%"},"style":"{\n      filter:\"drop-shadow(0px 5px 10px rgb(0, 0, 0))\"\n}","position":"absolute","alignX":"center","alignY":"center"},"ports":[{"name":"height","type":{"name":"number","units":["%","px","vh"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Height","default":"100","index":3}],"children":[]}]},{"id":"8516d9b6-01c3-efd8-c35e-0734c94c4f14","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentHeight","position":"absolute","alignY":"bottom"},"ports":[{"name":"width","type":{"name":"number","units":["%","px","vw"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Width","default":"100","index":2},{"name":"borderWidth","type":{"name":"number","units":["px"],"defaultUnit":"px"},"plug":"input","group":"Style","displayName":"Border Width","default":0,"index":353},{"name":"borderColor","type":"color","plug":"input","group":"Style","displayName":"Border Color","index":354}],"children":[{"id":"bbc2195b-3677-678a-5a3d-99d4b042f672","type":"Group","parameters":{"backgroundColor":"#E8423A","width":{"value":100,"unit":"px"},"height":{"value":80,"unit":"px"},"borderRadius":10,"marginLeft":{"value":5,"unit":"px"},"marginRight":{"value":5,"unit":"px"},"marginTop":{"value":5,"unit":"px"},"marginBottom":{"value":5,"unit":"px"}},"ports":[{"name":"width","type":{"name":"number","units":["%","px","vw"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Width","default":"100","index":2},{"name":"height","type":{"name":"number","units":["%","px","vh"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Height","default":"100","index":3},{"name":"borderWidth","type":{"name":"number","units":["px"],"defaultUnit":"px"},"plug":"input","group":"Style","displayName":"Border Width","default":0,"index":353},{"name":"borderColor","type":"color","plug":"input","group":"Style","displayName":"Border Color","index":354}],"children":[{"id":"56a5c04f-21ba-e19d-630b-4c18f0b9b1ce","type":"Text","parameters":{"position":"absolute","alignX":"center","alignY":"center","sizeMode":"contentSize","text":"Connect"},"ports":[],"children":[]}]},{"id":"0c274605-69b9-e377-c701-09660d934d64","type":"Group","parameters":{"backgroundColor":"#A92952","width":{"value":100,"unit":"px"},"height":{"value":80,"unit":"px"},"borderRadius":10,"marginLeft":{"value":5,"unit":"px"},"marginRight":{"value":5,"unit":"px"},"marginTop":{"value":5,"unit":"px"},"marginBottom":{"value":5,"unit":"px"}},"ports":[{"name":"width","type":{"name":"number","units":["%","px","vw"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Width","default":"100","index":2},{"name":"height","type":{"name":"number","units":["%","px","vh"],"defaultUnit":"%"},"plug":"input","group":"Dimensions","displayName":"Height","default":"100","index":3},{"name":"borderWidth","type":{"name":"number","units":["px"],"defaultUnit":"px"},"plug":"input","group":"Style","displayName":"Border Width","default":0,"index":353},{"name":"borderColor","type":"color","plug":"input","group":"Style","displayName":"Border Color","index":354}],"children":[{"id":"db1620b9-aaae-9795-a7cd-e5e7e88ba617","type":"Text","parameters":{"sizeMode":"contentSize","text":"Disconect","position":"absolute","alignX":"center","alignY":"center"},"ports":[],"children":[]}]}]},{"id":"b7097bb6-1b1d-ba11-2e72-dd7c9b03b239","type":"Group","parameters":{"position":"absolute","sizeMode":"contentSize"},"ports":[{"name":"borderWidth","type":{"name":"number","units":["px"],"defaultUnit":"px"},"plug":"input","group":"Style","displayName":"Border Width","default":0,"index":353},{"name":"borderColor","type":"color","plug":"input","group":"Style","displayName":"Border Color","index":354}],"children":[{"id":"9173490c-9b86-7741-e515-618d6f36d4cf","type":"Text","parameters":{"sizeMode":"contentSize","text":"Disconect","color":"#FFFFFF","fontFamily":"Arial Black","fontSize":{"value":30,"unit":"px"}},"ports":[],"children":[]},{"id":"3856e632-78f4-2e8d-31c6-a9da84158123","type":"Text","parameters":{"sizeMode":"contentSize","text":"Disconect","color":"#FFFFFF","fontFamily":"Arial Black","fontSize":{"value":30,"unit":"px"}},"ports":[],"children":[]},{"id":"62c93f90-fe06-0fd5-e0df-12ea225db408","type":"Text","parameters":{"sizeMode":"contentSize","text":"Disconect","color":"#FFFFFF","fontFamily":"Arial Black","fontSize":{"value":30,"unit":"px"}},"ports":[],"children":[]}]}]},{"id":"c4eade94-6e61-23a9-69a9-eb8a92b47b2f","type":"Script Downloader","parameters":{"input 0":"https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"},"ports":[{"name":"input 0","displayName":"Script 0","type":"string","plug":"input","group":"External scripts","index":2},{"name":"input 1","displayName":"Script 1","type":"string","plug":"input","group":"External scripts","index":3}],"children":[]},{"id":"3936949e-80c8-cee1-6d1c-d77a82ce430c","type":"Javascript2","parameters":{"code":"//micro:bit BLE UUID\nvar ACCELEROMETERSERVICE_SERVICE_UUID       = 'e95d0753-251d-470a-a062-fa1922dfa9a8';\nvar ACCELEROMETERDATA_CHARACTERISTIC_UUID   = 'e95dca4b-251d-470a-a062-fa1922dfa9a8';\nvar accelerometer_device;\nvar accelerometer_characteristic;\nvar accX,accY,accZ;\n    \ndefine({\n\t// The input ports of the Javascript node, name of input and type\n\tinputs:{\n\t    // ExampleInput:'number',\n\t    // Available types are 'number', 'string', 'boolean', 'color' and 'signal',\n\t    connect:'signal',\n\t    disconnect:'signal',\n\t    mySignal:\"signal\"\n\t},\n\t\n\t// The output ports of the Javascript node, name of output and type\n\toutputs:{\n\t    // ExampleOutput:'string',\n\t    accX: \"number\",\n\t    accY: \"number\",\n\t    accZ: \"number\"\n\t},\n\t\n\tconnect:function(inputs,outputs) {\n\t\t    navigator.bluetooth.requestDevice({\n            filters: [{\n              namePrefix: 'BBC micro:bit',\n            }],\n            optionalServices: [ACCELEROMETERSERVICE_SERVICE_UUID],\n            \n          })\n          .then(device => {\n            accelerometer_device = device;\n            console.log(\"device\", device);\n            return device.gatt.connect();\n          })\n          //ACCELEROMETER\n          .then(server =>{\n            console.log(\"server\", server)\n            return server.getPrimaryService(ACCELEROMETERSERVICE_SERVICE_UUID);\n          })\n          .then(service => {\n            console.log(\"service\", service)\n            return service.getCharacteristic(ACCELEROMETERDATA_CHARACTERISTIC_UUID)\n          })\n          .then(chara => {\n            console.log(\"ACCELEROMETER:\", chara)\n            console.log(\"BLE接続が完了しました。\");\n            characteristic = chara;\n            characteristic.startNotifications();\n            characteristic.addEventListener('characteristicvaluechanged',onAccelerometerValueChanged);\n          })  \n          .catch(error => {\n            console.log(\"BLE接続に失敗しました。もう一度試してみてください\");\n            console.log(error);\n          });    \n\t},\n\t\n\tdisconnect:function(inputs,outputs) {\n\t\tif (!accelerometer_device || !accelerometer_device.gatt.connected) return ;\n        accelerometer_device.gatt.disconnect();\n        console.log(\"BLE接続を切断しました。\");\n\t},\n\t\n\tchange:function(inputs,outputs) {\n\t\tthis.runNextFrame();\n\t\toutputs.accX = accX;\n\t    this.flagOutputDirty(\"accX\");\n\t    outputs.accY = accY;\n\t    this.flagOutputDirty(\"accY\");\n\t    outputs.accZ = accZ;\n\t    this.flagOutputDirty(\"accZ\");\n\t}\n})\n\nfunction onAccelerometerValueChanged(event) {\n    //AcceleratorX = event.target.value.getUint16(0)/1000.0;\n    AcceleratorX = event.target.value.getInt16(0,true)/1000.0;\n    accX = AcceleratorX;\n    console.log(\"TargetValue=\"+event.target.value);\n    \n    //AcceleratorY = event.target.value.getUint16(2)/1000.0;\n    AcceleratorY = event.target.value.getInt16(2,true)/1000.0;\n    accY = AcceleratorY;\n\n    //AcceleratorZ = event.target.value.getUint16(4)/1000.0;\n    AcceleratorZ = event.target.value.getInt16(4,true)/1000.0;\n    accZ = AcceleratorZ;\n    console.log(\"XYZ=\"+Math.round(AcceleratorX)+\"Y=\"+Math.round(AcceleratorY)+\"Z=\"+Math.round(AcceleratorZ));\n} \n"},"ports":[{"name":"code","type":{"name":"string","allowEditOnly":true,"codeeditor":"javascript"},"plug":"input","group":"Code","displayName":"Code","default":"define({\n\t// The input ports of the Javascript node, name of input and type\n\tinputs:{\n\t    // ExampleInput:'number',\n\t    // Available types are 'number', 'string', 'boolean', 'color' and 'signal',\n\t    mySignal:'signal',\n\t},\n\t\n\t// The output ports of the Javascript node, name of output and type\n\toutputs:{\n\t    // ExampleOutput:'string',\n\t},\n\t\n\t// All signal inputs need their own function with the corresponding name that\n\t// will be run when a signal is received on the input.\n\tmySignal:function(inputs,outputs) {\n\t\t// ...\n\t},\n\t\n\t// This function will be called when any of the inputs have changed\n\tchange:function(inputs,outputs) {\n\t\t// ...\n\t}\n})\n","index":1},{"name":"connect","plug":"input","type":{"name":"signal"},"group":"Inputs","index":2},{"name":"disconnect","plug":"input","type":{"name":"signal"},"group":"Inputs","index":3},{"name":"mySignal","plug":"input","type":{"name":"signal"},"group":"Inputs","index":4},{"name":"accX","type":{"name":"number"},"plug":"output","group":"Outputs","index":5},{"name":"accY","type":{"name":"number"},"plug":"output","group":"Outputs","index":6},{"name":"accZ","type":{"name":"number"},"plug":"output","group":"Outputs","index":7}],"children":[]},{"id":"00ea3340-206e-5e05-4c9c-f16c4ef76205","type":"Javascript2","parameters":{"code":"define({\r\n\tinputs:{\r\n\t    mySignal:'signal',\r\n\t    DOM:'domelement',\r\n\t    scriptLoaded:'string',\r\n        accX:'number',\r\n        accY:'number',\r\n        accZ:'number',\r\n\t},\r\n\t\r\n\toutputs:{\r\n\t    // ExampleOutput:'string',\r\n\t},\r\n\t\r\n\tmySignal:function(inputs,outputs) {\r\n        // レンダラーを作成\r\n        // サイズを指定\r\n        const width = window.innerWidth;\r\n        const height = window.innerHeight;\r\n\r\n        // 角度\r\n        let rot = 0;\r\n\r\n        // レンダラーを作成\r\n        const renderer = new THREE.WebGLRenderer({\r\n          canvas: inputs.DOM\r\n        });\r\n        renderer.setPixelRatio(window.devicePixelRatio);\r\n        renderer.setSize(width, height);\r\n\r\n        // シーンを作成\r\n        const scene = new THREE.Scene();\r\n\r\n        // 画面上にグリッド（格子）を配置\r\n        const grid = new THREE.GridHelper(1000, 10);\r\n        scene.add(grid);\r\n\r\n        // 画面上に3軸を配置\r\n        const axes = new THREE.AxesHelper(1000);\r\n        scene.add(axes);\r\n\r\n        // カメラを作成\r\n        const camera = new THREE.PerspectiveCamera(45, width / height);\r\n        camera.position.set(0, 500, +1000);\r\n        camera.lookAt(new THREE.Vector3(0, 0, 0));\r\n\r\n        // 平行光源\r\n        const directionalLight = new THREE.DirectionalLight(0xffffff);\r\n        directionalLight.position.set(1, 1, 1);\r\n        scene.add(directionalLight); // シーンに追加\r\n\r\n        // 球体を作成\r\n        const geometry = new THREE.SphereGeometry(300, 30, 30);\r\n        // 画像を読み込む\r\n        const loader = new THREE.TextureLoader();\r\n        const texture = loader.load('imgs/earthmap1k.jpg');\r\n        // マテリアルにテクスチャーを設定\r\n        const material = new THREE.MeshStandardMaterial({\r\n          map: texture\r\n        });\r\n        // メッシュを作成\r\n        const mesh = new THREE.Mesh(geometry, material);\r\n        // 3D空間にメッシュを追加\r\n        scene.add(mesh);\r\n\r\n        tick();\r\n\r\n        // 毎フレーム時に実行されるループイベントです\r\n        function tick() {\r\n          rot = inputs.accX;\r\n          pit = inputs.accY;\r\n\r\n          // ラジアンに変換\r\n          const radianX = (rot * Math.PI) / 180;\r\n          const radianY = (pit * Math.PI) / 180;\r\n\r\n          // ライトの座標に反映\r\n          camera.position.x = 1000 *Math.cos(radianX);\r\n          camera.position.y = 500;\r\n          camera.position.z = 1000 * Math.sin(radianX);\r\n          // ライトの座標に反映\r\n          //camera.position.z = 1000 *Math.cos(radianX);\r\n          //camera.position.x = 1000 *Math.sin(radianX)* Math.cos(radianY);\r\n          //camera.position.y = 1000 * Math.sin(radianX)*Math.sin(radianY);\r\n\r\n          // カメラは常に中央を向くように指定\r\n          camera.lookAt(new THREE.Vector3(0, 0, 0));\r\n\r\n          // レンダリング\r\n          renderer.render(scene, camera);\r\n          requestAnimationFrame(tick);\r\n        }\r\n\t},\r\n\t\r\n\t// This function will be called when any of the inputs have changed\r\n\tchange:function(inputs,outputs) {\r\n\t\t// ...\r\n\t\t      console.log(\"change\");\r\n\t}\r\n})\r\n","useExternalFile":"no","externalFile":"Three05.js"},"ports":[{"name":"code","type":{"name":"string","allowEditOnly":true,"codeeditor":"javascript"},"plug":"input","group":"Code","displayName":"Code","default":"define({\n\t// The input ports of the Javascript node, name of input and type\n\tinputs:{\n\t    // ExampleInput:'number',\n\t    // Available types are 'number', 'string', 'boolean', 'color' and 'signal',\n\t    mySignal:'signal',\n\t},\n\t\n\t// The output ports of the Javascript node, name of output and type\n\toutputs:{\n\t    // ExampleOutput:'string',\n\t},\n\t\n\t// All signal inputs need their own function with the corresponding name that\n\t// will be run when a signal is received on the input.\n\tmySignal:function(inputs,outputs) {\n\t\t// ...\n\t},\n\t\n\t// This function will be called when any of the inputs have changed\n\tchange:function(inputs,outputs) {\n\t\t// ...\n\t}\n})\n","index":1},{"name":"mySignal","plug":"input","type":{"name":"signal"},"group":"Inputs","index":2},{"name":"DOM","plug":"input","type":{"name":"domelement"},"group":"Inputs","index":3},{"name":"scriptLoaded","plug":"input","type":{"name":"string"},"group":"Inputs","index":4},{"name":"accX","plug":"input","type":{"name":"number"},"group":"Inputs","index":5},{"name":"accY","plug":"input","type":{"name":"number"},"group":"Inputs","index":6},{"name":"accZ","plug":"input","type":{"name":"number"},"group":"Inputs","index":7}],"children":[]},{"id":"056b0372-718a-2f37-92fa-9109890c0d65","type":"Number Remapper","parameters":{"maxOutputValue":180,"maxInputValue":1,"minInputValue":-1,"minOutputValue":-180},"ports":[],"children":[]},{"id":"4816fd68-bec7-7307-9542-a6c39f4c567c","type":"String Format","parameters":{"format":"X={accX}"},"ports":[{"name":"accX","type":"string","plug":"input","index":2}],"children":[]},{"id":"230e914c-0e0a-447b-e2d9-a30680cd916e","type":"String Format","parameters":{"format":"Y={accY}"},"ports":[{"name":"accY","type":"string","plug":"input","index":2}],"children":[]},{"id":"8d1ebe41-44ce-ecf2-847a-f4f36e54778e","type":"String Format","parameters":{"format":"Z={accZ}"},"ports":[{"name":"accZ","type":"string","plug":"input","index":2}],"children":[]}],"connections":[{"sourceId":"bbc2195b-3677-678a-5a3d-99d4b042f672","sourcePort":"onClick","targetId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","targetPort":"connect"},{"sourceId":"0c274605-69b9-e377-c701-09660d934d64","sourcePort":"onClick","targetId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","targetPort":"disconnect"},{"sourceId":"3bd767ce-d2aa-6730-64a5-ba3ec4066371","sourcePort":"onElementCreated","targetId":"00ea3340-206e-5e05-4c9c-f16c4ef76205","targetPort":"DOM"},{"sourceId":"c4eade94-6e61-23a9-69a9-eb8a92b47b2f","sourcePort":"loaded","targetId":"00ea3340-206e-5e05-4c9c-f16c4ef76205","targetPort":"mySignal"},{"sourceId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","sourcePort":"accX","targetId":"056b0372-718a-2f37-92fa-9109890c0d65","targetPort":"inputValue"},{"sourceId":"056b0372-718a-2f37-92fa-9109890c0d65","sourcePort":"remappedValue","targetId":"00ea3340-206e-5e05-4c9c-f16c4ef76205","targetPort":"accX"},{"sourceId":"4816fd68-bec7-7307-9542-a6c39f4c567c","sourcePort":"formatted","targetId":"9173490c-9b86-7741-e515-618d6f36d4cf","targetPort":"text"},{"sourceId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","sourcePort":"accX","targetId":"4816fd68-bec7-7307-9542-a6c39f4c567c","targetPort":"accX"},{"sourceId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","sourcePort":"accY","targetId":"230e914c-0e0a-447b-e2d9-a30680cd916e","targetPort":"accY"},{"sourceId":"3936949e-80c8-cee1-6d1c-d77a82ce430c","sourcePort":"accZ","targetId":"8d1ebe41-44ce-ecf2-847a-f4f36e54778e","targetPort":"accZ"},{"sourceId":"230e914c-0e0a-447b-e2d9-a30680cd916e","sourcePort":"formatted","targetId":"3856e632-78f4-2e8d-31c6-a9da84158123","targetPort":"text"},{"sourceId":"8d1ebe41-44ce-ecf2-847a-f4f36e54778e","sourcePort":"formatted","targetId":"62c93f90-fe06-0fd5-e0df-12ea225db408","targetPort":"text"}],"ports":[],"roots":["ba2f28d3-9d3a-8dfe-ba80-4f1e5bd5b292"]}],"rootComponent":"/MicrobitControl","rootNode":"ba2f28d3-9d3a-8dfe-ba80-4f1e5bd5b292","metadata":{"deviceSettings":{"deviceTypes":[{"name":"BLEControl","desc":"This is the default device that can be used to view the app from a browser.","rootComponentPath":"/MicrobitControl","type":"Browser"}]}}};
</script>



<script src="noodl.js"></script>
</body>
</html>
